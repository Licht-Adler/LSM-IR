library(Matrix)
library(sn)
library(mgcv)

#######################################################################################################
############################### Inverse Mills Ratio with its Derivative ###############################
#######################################################################################################
zeta1 <- function(x) { 
             z1 <- ifelse(x > -50, 
                          exp(dnorm(x, log = TRUE) - pnorm(x, log.p = TRUE)), 
                          -x / (1 - 1 / (x^2 + 2) + 1 / ((x^2 + 2) * (x^2 + 4)) - 5 / ((x^2 + 2) * 
                              (x^2 + 4) * (x^2 + 6)) + 9 / ((x^2 + 2) * (x^2 + 4) * (x^2 + 6) * 
                              (x^2 + 8)) - 129 / ((x^2 + 2) * (x^2 + 4) * (x^2 + 6) * (x^2 + 8) * 
                              (x^2 + 10)))
                          )
              return(z1)
}

zeta2 <- function(x) { 
             z2 <- -zeta1(x) * (x + zeta1(x))
             return(z2)
}
#######################################################################################################
#######################################################################################################
#######################################################################################################
